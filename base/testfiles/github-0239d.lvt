
\documentclass{article}

\input{test2e}

\showoutput

\def\test#1#2{{\fontencoding{#1}\selectfont#2}}

\ifx\Umathchar\UNDEFINED\else
  {\fontencoding{TU}\selectfont}%
\fi

\START

\let\undeclare\UndeclareTextCommand
\let\declare\DeclareTextCompositeCommand
\begin{document}
\let\UndeclareTextCommand\undeclare
\let\DeclareTextCompositeCommand\declare

\ifx\Umathchar\UNDEFINED

\test{T1}{\`a}
\test{OT1}{\`a}

\NewCommandCopy\mygrave\`
\show\mygrave
\expandafter\show\csname T1\string\mygrave\endcsname
\expandafter\show
  \csname\expandafter\string
    \csname T1\string\mygrave\endcsname-a\endcsname
\DeclareTextCompositeCommand{\`}{T1}{a}{ERROR}
\DeclareTextCompositeCommand{\`}{OT1}{a}{ERROR}

\test{T1}{\mygrave a}
\test{OT1}{\mygrave a}



\test{OMS}{\textbullet}
\test{TS1}{\textbullet}
\test{OT1}{\textbullet}
\test{T1}{\textbullet}

\NewCommandCopy\mybullet\textbullet
\show\mybullet
\expandafter\show\csname T1\string\mybullet\endcsname
\expandafter\show\csname TS1\string\mybullet\endcsname
\UndeclareTextCommand\textbullet{OMS}
\UndeclareTextCommand\textbullet{TS1}
\UndeclareTextCommand\textbullet{OT1}
\UndeclareTextCommand\textbullet{T1}

\test{OMS}{\mybullet}
\test{TS1}{\mybullet}
\test{OT1}{\mybullet}
\test{T1}{\mybullet}

\expandafter\let\csname @list@T1enc@composites\endcsname\relax
\NewCommandCopy\myquote\'
\show\myquote

\else

\test{TU}{\`a}

\NewCommandCopy\mygrave\`
\show\mygrave
\expandafter\show\csname TU\string\mygrave\endcsname
\expandafter\show
  \csname\expandafter\string
    \csname TU\string\mygrave\endcsname-a\endcsname
\DeclareTextCompositeCommand{\`}{TU}{a}{ERROR}

\test{TU}{\mygrave a}



\test{TU}{\textbullet}
\test{OMS}{\textbullet}
\test{TS1}{\textbullet}

\NewCommandCopy\mybullet\textbullet
\show\mybullet
\expandafter\show\csname TU\string\mybullet\endcsname
\UndeclareTextCommand\textbullet{TU}
\UndeclareTextCommand\textbullet{OMS}
\UndeclareTextCommand\textbullet{TS1}

\test{TU}{\mybullet}
\test{OMS}{\mybullet}
\test{TS1}{\mybullet}

\expandafter\let\csname @list@TUenc@composites\endcsname\relax
\NewCommandCopy\myquote\'
\show\myquote

\fi

\end{document}

