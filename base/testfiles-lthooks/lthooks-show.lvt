% for getting the examples in the code really ...

\ExplSyntaxOn
\debug_on:n { check-declarations , deprecation }
\ExplSyntaxOff

\documentclass{article}

\input{regression-test}
% Record the actual `\ShowHook`
\ExplSyntaxOn
\cs_set_eq:NN \new_hook_log:n \hook_log:n
\cs_set_eq:NN \new_hook_show:n \hook_show:n
\ExplSyntaxOff
\input{./lthooks-setup.tex}
\ExplSyntaxOn
\cs_set_eq:NN \old_hook_log:n  \hook_log:n
\cs_set_eq:NN \old_hook_show:n \hook_show:n
\cs_set_protected:Npn \OldLogHook { \old_hook_log:n }
\cs_set_protected:Npn \NewLogHook { \new_hook_log:n }
\cs_set_protected:Npn \OldShowHook { \old_hook_show:n }
\cs_set_protected:Npn \NewShowHook { \new_hook_show:n }
\ExplSyntaxOff

\START

\typeout{========== UNDECLARED}
\OldShowHook{HOOK NAME 0}
\NewShowHook{HOOK NAME 0}
\UseHook{HOOK NAME 0}
\typeout{========== + TOP LEVEL}
\AddToHook{HOOK NAME 0}{\typeout{[TOP LEVEL]}}
\OldShowHook{HOOK NAME 0}
\NewShowHook{HOOK NAME 0}
\UseHook{HOOK NAME 0}
\typeout{========== + LABEL 1}
\AddToHook{HOOK NAME 0}[LABEL 1]{\typeout{[code 1]}}
\OldShowHook{HOOK NAME 0}
\NewShowHook{HOOK NAME 0}
\UseHook{HOOK NAME 0}
\typeout{========== + LABEL 2}
\AddToHook{HOOK NAME 0}[LABEL 2]{\typeout{[code 2]}}
\OldShowHook{HOOK NAME 0}
\NewShowHook{HOOK NAME 0}
\UseHook{HOOK NAME 0}
\typeout{========== + LABEL 3}
\AddToHook{HOOK NAME 0}[LABEL 3]{\typeout{[code 3]}}
\OldShowHook{HOOK NAME 0}
\NewShowHook{HOOK NAME 0}
\UseHook{HOOK NAME 0}
\typeout{========== + NEXT}
\AddToHookNext{HOOK NAME 0}{\typeout{[Next only]}}
\OldShowHook{HOOK NAME 0}
\NewShowHook{HOOK NAME 0}
\UseHook{HOOK NAME 0}
\typeout{========== LABEL 3 < LABEL 1}
\DeclareHookRule{HOOK NAME 0}{LABEL 3}{before}{LABEL 1}
\OldShowHook{HOOK NAME 0}
\NewShowHook{HOOK NAME 0}
\UseHook{HOOK NAME 0}
\typeout{========== DEFAULT LABEL 2 > LABEL 3}
\DeclareDefaultHookRule{LABEL 2}{after}{LABEL 3}
\OldShowHook{HOOK NAME 0}
\NewShowHook{HOOK NAME 0}
\UseHook{HOOK NAME 0}

\typeout{============================================}

\typeout{========== UNDECLARED}
\OldShowHook{HOOK NAME}
\NewShowHook{HOOK NAME}
\UseHook{HOOK NAME}
\typeout{========== DECLARED EMPTY}
\NewHook{HOOK NAME}
\OldShowHook{HOOK NAME}
\NewShowHook{HOOK NAME}
\UseHook{HOOK NAME}
\typeout{========== + TOP LEVEL}
\AddToHook{HOOK NAME}{\typeout{[TOP LEVEL]}}
\OldShowHook{HOOK NAME}
\NewShowHook{HOOK NAME}
\UseHook{HOOK NAME}
\typeout{========== + LABEL 1}
\AddToHook{HOOK NAME}[LABEL 1]{\typeout{[code 1]}}
\OldShowHook{HOOK NAME}
\NewShowHook{HOOK NAME}
\UseHook{HOOK NAME}
\typeout{========== + LABEL 2}
\AddToHook{HOOK NAME}[LABEL 2]{\typeout{[code 2]}}
\OldShowHook{HOOK NAME}
\NewShowHook{HOOK NAME}
\UseHook{HOOK NAME}
\typeout{========== + LABEL 3}
\AddToHook{HOOK NAME}[LABEL 3]{\typeout{[code 3]}}
\OldShowHook{HOOK NAME}
\NewShowHook{HOOK NAME}
\UseHook{HOOK NAME}
\typeout{========== + NEXT}
\AddToHookNext{HOOK NAME}{\typeout{[Next only]}}
\OldShowHook{HOOK NAME}
\NewShowHook{HOOK NAME}
\UseHook{HOOK NAME}
\typeout{========== LABEL 3 < LABEL 1}
\DeclareHookRule{HOOK NAME}{LABEL 3}{before}{LABEL 1}
\OldShowHook{HOOK NAME}
\NewShowHook{HOOK NAME}
\UseHook{HOOK NAME}
\typeout{========== DEFAULT LABEL 2 > LABEL 3}
\DeclareDefaultHookRule{LABEL 2}{after}{LABEL 3}
\OldShowHook{HOOK NAME}
\NewShowHook{HOOK NAME}
\UseHook{HOOK NAME}

\typeout{============================================}

\typeout{========== UNDECLARED}
\OldShowHook{EMAN KOOH}
\NewShowHook{EMAN KOOH}
\UseHook{EMAN KOOH}
\typeout{========== DECLARED REVERSED}
\NewReversedHook{EMAN KOOH}
\OldShowHook{EMAN KOOH}
\NewShowHook{EMAN KOOH}
\UseHook{EMAN KOOH}
\typeout{========== + TOP LEVEL}
\AddToHook{EMAN KOOH}{\typeout{[TOP LEVEL]}}
\OldShowHook{EMAN KOOH}
\NewShowHook{EMAN KOOH}
\UseHook{EMAN KOOH}
\typeout{========== + LABEL 1}
\AddToHook{EMAN KOOH}[LABEL 1]{\typeout{[code 1]}}
\OldShowHook{EMAN KOOH}
\NewShowHook{EMAN KOOH}
\UseHook{EMAN KOOH}
\typeout{========== + LABEL 2}
\AddToHook{EMAN KOOH}[LABEL 2]{\typeout{[code 2]}}
\OldShowHook{EMAN KOOH}
\NewShowHook{EMAN KOOH}
\UseHook{EMAN KOOH}
\typeout{========== + LABEL 3}
\AddToHook{EMAN KOOH}[LABEL 3]{\typeout{[code 3]}}
\OldShowHook{EMAN KOOH}
\NewShowHook{EMAN KOOH}
\UseHook{EMAN KOOH}
\typeout{========== + NEXT}
\AddToHookNext{EMAN KOOH}{\typeout{[Next only]}}
\OldShowHook{EMAN KOOH}
\NewShowHook{EMAN KOOH}
\UseHook{EMAN KOOH}
\typeout{========== + LABEL 3 < LABEL 1}
\DeclareHookRule{EMAN KOOH}{LABEL 3}{before}{LABEL 1}
\OldShowHook{EMAN KOOH}
\NewShowHook{EMAN KOOH}
\UseHook{EMAN KOOH}
\typeout{========== + DEFAULT LABEL 2 > LABEL 3}
\DeclareDefaultHookRule{LABEL 2}{after}{LABEL 3}
\OldShowHook{EMAN KOOH}
\NewShowHook{EMAN KOOH}
\UseHook{EMAN KOOH}

\typeout{============================================}

\typeout{UNKNOWN ENVIRONMENT}
\OldShowHook{env/lthooks.regression test/before}
\NewShowHook{env/lthooks.regression test/before}
\typeout{CREATING ENVIRONMENT}
\NewDocumentEnvironment{lthooks.regression test}{}{}{}
\OldShowHook{env/lthooks.regression test/before}
\NewShowHook{env/lthooks.regression test/before}

\typeout{============================================}

\typeout{========== GENERIC HOOK}

\OldShowHook{GENERIC}
\NewShowHook{GENERIC}
\AddToHook{GENERIC}[LABEL]{\typeout{[CODE]}}
\OldShowHook{GENERIC}
\NewShowHook{GENERIC}
\UseHook{GENERIC}
\typeout{========== ACTIVATE GENERIC HOOK}
\ActivateGenericHook{GENERIC}
\OldShowHook{GENERIC}
\NewShowHook{GENERIC}
\UseHook{GENERIC}

\typeout{============================================}

\typeout{========== HOOK WITH ARGUMENTS A}

\OldShowHook{HWA-a)}
\NewShowHook{HWA-a)}
\NewHookWithArguments{HWA-a)}{2}
\OldShowHook{HWA-a)}
\NewShowHook{HWA-a)}

\typeout{============================================}


\typeout{!!!! If this test changes the documentation needs updating !!!!}

\END
